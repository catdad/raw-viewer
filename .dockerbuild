FROM ubuntu:18.04

COPY . /app

ENV DEBIAN_FRONTEND noninteractive

RUN apt update -q
RUN apt install --yes -q build-essential gdebi-core wget xvfb curl gnupg
RUN wget -q https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
RUN gdebi --non-interactive --quiet google-chrome-stable_current_amd64.deb
RUN curl -sL https://deb.nodesource.com/setup_10.x | bash \
    && apt install --yes nodejs

RUN node -v
RUN npm -v

WORKDIR /app
RUN ls

RUN npm ci --unsafe-perm
RUN npm run citest
